//	----------------------------------------- 
//	Element â€” A base, mixin and options
//	Style anything consistently
//	Works well for anything else you'd like to style similar apart from buttons/forms
//	-----------------------------------------

// consistent stuff for each button
// ---------------------------
%element-base {
	@include background-clip;
	@include transition(none);
	@include appearance(none);
	@include user-select(none);
	position: relative;
	font-family: $element; }

// calculate padding for top + bottom and left + right.
// looks a fairly odd way to do it but generally works
// quite well. basis is on 16px = 1em.
// ---------------------------
@function element-size($size: 3) {
	@return (.75 * ($size / 4.75)) + em (1.5 * ($size / 3)) + em; }

// separate the bulk of the styling into a mixin for ease of editing
// $main-color is overridden by the element mixin below
// ---------------------------
@mixin element-shading($main-color: $alt, $state: normal) {
	
	@if $state == hover { $main-color: scale-lightness($main-color, 10%); }
	@else if $state == active { $main-color: scale-lightness($main-color, if-bright($main-color, -10%, -5%)); }
	
	$light-color: scale-lightness($main-color, if-bright($main-color, 25%, 15%));
	$dark-color: scale-lightness($main-color, if-bright($main-color, -15%, -25%));
	
	@if red($main-color) > green($main-color) and 
			green($main-color) > blue($main-color) and
			green($main-color) > 90 { 
				$dark-color: scale-lightness(
					adjust-hue($main-color, -12deg), 
					if-bright($main-color, -5%, -15%)); }
	@if blue($main-color) > green($main-color) and 
			blue($main-color) > red($main-color) or
			green($main-color) > red($main-color) and 
			green($main-color) > blue($main-color) { 
				$dark-color: scale-lightness(
					adjust-hue($main-color, 12deg), 
					if-bright($main-color, -5%, -15%)); }
	
	$shadow-color: scale-lightness($main-color, if-bright($main-color, -50%, -65%)); 
	
	@if $state == hover {
		@include background(linear-gradient($main-color, $dark-color));
		@include box-shadow(
			inset 0 0 0 1px rgba($shadow-color, .3),
			inset 0 2px 0 rgba($light-color, .8),
			inset 12px 0 18px -12px rgba($dark-color, .4),
			inset -12px 0 18px -12px rgba($dark-color, .4),
			0 1px 3px rgba($shadow-color, .3));
		text-shadow: 0 1px 1px rgba($shadow-color, .6); }
	@else if $state == active {
		@include background(linear-gradient($main-color, $dark-color));
		@include box-shadow(
			inset 0 0 0 1px rgba($shadow-color, .3),
			inset 0 1px 3px rgba($shadow-color, .6),
			inset 12px 0 18px -12px rgba($dark-color, .4),
			inset -12px 0 18px -12px rgba($dark-color, .4),
			0 1px 1px rgba($light-color, .3));
		text-shadow: 0 1px 1px rgba($shadow-color, .6); }
	@else {		
		@include background(linear-gradient($main-color, $dark-color));
		@include box-shadow(
			inset 0 0 0 1px rgba($shadow-color, .3),
			inset 0 2px 0 rgba($light-color, .8),
			inset 12px 0 18px -12px rgba($dark-color, .4),
			inset -12px 0 18px -12px rgba($dark-color, .4),
			0 1px 3px rgba($shadow-color, .3));
		text-shadow: 0 1px 1px rgba($shadow-color, .6); } }

// the actual mixin, 
// has modernizr classes for features that don't exist
// - border is set due to it being done with the box-shadow
// - could use simple background fallback for gradient,
//   though this keeps web inspector that bit cleaner
// ---------------------------
@mixin element(
	$main-color: $alt,
	$text-color: $white,
	$radius: $radius, 
	$subtle: false,
	$subtle-color: $default-subtle-color,
	$shadow: true, // disable for a flat button
	$style: true, // disable for basic styles like padding and reset only
	$size: 3, 
	$hover: false, // off by default as you can set this for alert/notice type things
	$font-size: false, // set the font-size manually
	$display: inline-block) {
	
	@extend %element-base;		
	display: $display;
	
	@if $size != false 		{ padding: element-size($size); }
	@if $font-size 				{ font-size: $font-size; }
	@if $subtle != true 	{ color: $text-color; }
	@else 								{ color: $subtle-color; }
	@if $radius 					{ @include border-radius($radius); }
	
	// you may just want a button without style 
	// as sometimes you may just want a nice start
	// padding, etc
	@if $style {
		// subtle start
		@if $subtle {
			@include box-shadow(inset 0 0 0 1px fade-out($subtle-color, 1));
			.no-boxshadow & {
				border: 1px solid transparent; } } // close $subtle true
		
		// non subtle start		
		@else {
			@if $shadow {
				@include element-shading($main-color, normal);
				// modernizr stuff
				.no-boxshadow & {
					border: 1px solid scale-lightness($main-color, -10%); }
				.no-cssgradients & {
					background: $main-color; } }
			@else {
				background: $main-color; } } // close else
				
		@if $hover {
			&:hover, &:focus {
				@if $subtle { color: $text-color; }
				@if $shadow {
					@include element-shading($main-color, hover);
					// modernizr stuff
					.no-boxshadow & {
						border: 1px solid scale-lightness($main-color, 10%); }
					.no-cssgradients & {
						background: scale-lightness($main-color, 20%); } }
				@else {
					background: scale-lightness($main-color, 10%); } }
					
			&:active {
				@if $shadow {
					@include element-shading($main-color, active);
					// modernizr stuff
					.no-boxshadow & {
						border: 1px solid scale-lightness($main-color, -20%); }
					.no-cssgradients & {
						background: scale-lightness($main-color, -10%); } }
				@else {
					background: scale-lightness($main-color, -10%); } } } } // close $style
}